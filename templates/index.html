<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <title>Deteksi Plagiarisme Dokumen</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB"
          crossorigin="anonymous">

    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="icon" href="{{ url_for('static', filename='image/logo-umsu-tanpa-tulisan.png') }}" type="image/x-icon">
</head>
<body>

<!-- LOGO -->
<div class="container">
    <div class="logo text-center my-4">
        <img src="{{ url_for('static', filename='image/logo-umsu-tanpa-tulisan.png') }}" alt="Logo UMSU" width="90">
    </div>
</div>

<!-- MAIN CARD -->
<div class="container">
    <div class="cover p-4 shadow rounded">

        <h2 class="text-center">Sistem Deteksi Plagiarisme</h2>
        <hr>

        <!-- FORM -->
        <form method="POST" enctype="multipart/form-data" onsubmit="showLoading()">
            <label class="form-label">Upload Dokumen (PDF / DOCX)</label>
            <input type="file" class="form-control mb-3" name="doc" accept=".pdf,.docx" required>
            <button type="submit" class="btn btn-primary w-100">Cek Plagiarisme</button>
        </form>

        <!-- LOADING -->
        <div class="text-center mt-4" id="loading" style="display: none;">
            <div class="spinner-border text-primary" role="status"></div>
            <p class="mt-2">Memproses dokumen, mohon tunggu...</p>
        </div>

        <!-- HASIL AKHIR -->
        {% if result %}
        <div class="result text-center mt-4" id="cover">
            <p class="fw-bold">Persentase Kemiripan</p>
            <h1>{{ result.score }}%</h1>

            {% if result.status == "PLAGIARISME" %}
                <p class="plagiat text-danger fw-bold">{{ result.status }}</p>
            {% else %}
                <p class="aman text-success fw-bold">{{ result.status }}</p>
            {% endif %}
        </div>
        {% endif %}

        <!-- TABEL DETAIL -->
        {% if details %}
        <hr>
        <h4 class="mt-4">Detail Perbandingan Dokumen</h4>

        <div class="table-responsive">
            <table class="table table-bordered table-striped mt-3">
                <thead class="table-dark text-center">
                    <tr>
                        <th>No</th>
                        <th>Nama Dokumen Dataset</th>
                        <th>Rabin-Karp (%)</th>
                        <th>Cosine Similarity (%)</th>
                        <th>Hybrid (%)</th>
                    </tr>
                </thead>
                <tbody>
                    {% for d in details %}
                    <tr class="text-center">
                        <td>{{ loop.index }}</td>
                        <td>{{ d.ref }}</td>
                        <td>{{ d.rk }}</td>
                        <td>{{ d.cs }}</td>
                        <td>
                            {% if d.hybrid >= 50 %}
                                <span class="text-danger fw-bold">{{ d.hybrid }}</span>
                            {% else %}
                                <span class="text-success">{{ d.hybrid }}</span>
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% endif %}

        <!-- ERROR -->
        {% if error %}
        <div class="alert alert-danger mt-4 text-center">
            {{ error }}
        </div>
        {% endif %}

    </div>
</div>

<!-- SCRIPT -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
        crossorigin="anonymous"></script>

<script>
function showLoading() {
    const cover = document.getElementById("cover");
    if (cover) cover.style.display = "none";
    document.getElementById("loading").style.display = "block";
}
</script>

</body>
</html>
